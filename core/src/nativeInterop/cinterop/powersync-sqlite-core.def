package = com.powersync.sqlite.core
headers = sqlite3.h
headerFilter = sqlite3*.h
compilerOpts = -I$projectDir/build/native/sqlite
noStringConversion = sqlite3_prepare_v2 sqlite3_prepare_v3
---

SQLITE_API int sqlite3_enable_load_extension(sqlite3 *db, int onoff);

SQLITE_API int sqlite3_load_extension(
  sqlite3 *db,          /* Load the extension into this database connection */
  const char *zFile,    /* Name of the shared library containing extension */
  const char *zProc,    /* Entry point.  Derived from zFile if 0 */
  char **pzErrMsg       /* Put error message here if not 0 */
);

extern int sqlite3_powersync_init(sqlite3 *db, char **pzErrMsg,
                                  const sqlite3_api_routines *pApi);

static int init_powersync_sqlite_extension() {
    int result =
        sqlite3_auto_extension((void (*)(void)) &sqlite3_powersync_init);
    return result;
}
